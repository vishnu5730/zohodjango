{% extends 'base.html' %} 
{% load static %} 
{% block content %}

 <style>
  @media screen and (max-width: 600px) {
    .col-25,
    .col-75,
    input[type="submit"] {
      width: 100%;
      margin-top: 0;
    }
    input[type="text"],
    select,
    textarea {
      width: 100%;
    }
  }

  .form-check {
    margin-bottom: 10px;
  }

  /* style submit button */
  button[type="submit"] {
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
  }

  button[type="submit"]:hover {
    background-color: #0069d9;
  }
  /* Style for the highlighted account type options */
  option.highlight-account-type {
    background-color: #f3f3f3; /* Example background color */
    color: #666; /* Example text color */
    font-weight: bold; /* Example font weight */
    /* Add any other styles you want to customize the look of the highlighted account type options */
  }

  /* Additional style for hovering over the highlighted account type options (optional) */
  option.highlight-account-type:hover {
    background-color: #f5f5f5; /* Example hover background color */
    /* Add any other styles you want for the hover state */
  }
  .highlight-account-type {
    text-align: left;
    padding-left: 10px;
  }
  .modal {
    z-index: 9999;
    overflow: scroll;
  }
  ::-webkit-scrollbar {
    width: 10px;
  }

  /* Track */
  ::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  /* Handle */
  ::-webkit-scrollbar-thumb {
    background: #888;
  }

  /* Handle on hover */
  ::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
</style> 
 <div style="margin-top: 2rem; margin-left: 8rem">
  <h2>New Recurring Expenses</h2>
  <div style="height: 1700px">
    <form
      action="{% url 'add_expense' %}"
      method="post"
      id="expenseForm"
      enctype="multipart/form-data"
    >
      {% csrf_token %}

      <!-- Profile Name -->
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Profile Name</label>
        <div class="col-sm-6">
          <input
            type="text"
            class="form-control bg-white text-dark"
            name="profile_name"
            required
            style="width: 100%"
          />
          <div class="invalid-feedback">Please fill out this field.</div>
        </div>
      </div>

      <!-- Repeat Every -->
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Repeat Every</label>
        <div class="col-sm-6">
          <select
            class="form-control bg-light text-dark"
            id="repeat_select"
            name="repeat_every"
            style="color: #000 !important; width: 540px"
          >
            {% for repeat_item in repeat_list %}

            <option value="{{ repeat_item.id }}">
              {{ repeat_item.Terms }}
            </option>

            {% endfor %}
          </select>
        </div>
        <div class="input-group-append">
          <button
            class="btn btn-outline-warning"
            type="button"
            data-toggle="modal"
            id="openModal"
            data-target="#repeatevery"
            style="height: 38px; margin-left: -10px"
          >
            <b>+</b>
          </button>
        </div>
      </div>
      <!-- Start Date -->
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Start Date</label>
        <div class="col-sm-6">
          <input
            type="date"
            id="start_date"
            name="start_date"
            class="form-control bg-white text-dark"
            style="background-color: #2c2e33; color: black; width: 100%"
          />
        </div>
      </div>

      <!-- Expense Account -->
      <div class="form-group row mt-3">
        <label class="col-sm-3 col-form-label">Expense Account</label>
        <div class="col-sm-6">
          <div class="input-group">
            <select
              class="form-control bg-white text-dark"
              id="expense_account"
              name="expense_account"
            >
              <!-- Existing options and comment tags -->
            {% for account_type in account_types %}
              <optgroup label="{{ account_type }}">
              {% for account in accounts %} 
                {% if account.accountType == account_type %}
                <option value="{{ account.id }}">
                  {{ account.accountName }}
                </option>
                {% endif %} 
              {% endfor %}
              </optgroup>
            {% endfor %}
            </select>
            <div class="input-group">
              <button
                class="btn btn-outline-warning"
                type="button"
                data-toggle="modal"
                data-target="#newAccountModal"
                id="openModalBtn"
                style="height: 38px; margin-left: 550px; margin-top: -37px"
              >
                <b>+</b>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Refrence Id</label>
        <div class="col-sm-6">
          <input
            type="text"
            id="refrense"
            name="refrnsid"
            class="form-control bg-white text-dark"
            style="background-color: #2c2e33; color: black; width: 100%"
            value="{{num}}"
            readonly
          />
        </div>
      </div>
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label" style="margin-top: 8px"
          >Expense Type</label
        >
        <div class="col-sm-6" style="display: flex">
          <div class="form-check text-dark">
            <input
              class="form-check-input"
              type="radio"
              name="expense_type"
              id="expense_type1"
              value="goods"
            />
            <label class="form-check-label" for="expense_type1">Goods</label>
          </div>
          <div class="form-check" style="margin-left: 30px">
            <input
              class="form-check-input"
              type="radio"
              name="expense_type"
              id="expense_type2"
              value="services"
            />
            <label class="form-check-label" for="expense_type2">Services</label>
          </div>
          <div class="form-group" id="goods-bottom" style="display: none">
            <div style="margin-left: -300px">
              <label
                for="goods-label"
                style="margin-top: 84px; margin-left: -170px"
                >HSN</label
              >
            </div>
            <input
              type="text"
              class="form-control bg-white text-dark"
              id="goods-label"
              name="goods_label"
              oninput="validateHSN(this)"
              style="margin-left: -11.5rem; width: 550px; margin-top: -20px"
            />
            <small id="hsn-error" class="text-danger"></small>
          </div>
          <div class="form-group" id="services-bottom" style="display: none">
            <div style="margin-left: -300px">
              <label
                for="services-label"
                style="margin-top: 84px; margin-left: -170px"
                >SAC</label
              >
            </div>
            <input
              type="text"
              class="form-control bg-white text-dark"
              id="services-label"
              name="services_label"
              oninput="validateSAC(this)"
              style="margin-left: -11.5rem; width: 550px; margin-top: -20px"
            />
            <small id="sac-error" class="text-danger"></small>
          </div>
        </div>
      </div>

      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Amount</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <div class="input-group-prepend" style="margin-left: -151px">
            <select
              class="form-control bg-white text-dark"
              id="currency"
              name="currency"
              style="
                width: 50px;
                margin-left: 151px;
                color: white;
                margin-top: -8px;
              "
            >
              <option value="INR">INR</option>
            </select>
          </div>
          <input
            type="text"
            id="amount"
            name="amount"
            class="form-control bg-white text-dark"
            style="
              background-color: #2c2e33;
              color: black;
              margin-top: -38px;
              width: 500px;
              margin-left: 48px;
            "
          />
        </div>
      </div>
      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Paid Through</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <select
            name="paidthrough"
            id="paidthrough"
            class="form-control bg-white text-dark"
            style="width: 550px"
          >
            <option value="Cash">Cash</option>
            <option value="Cheque">cheque</option>
            <option value="UPI">UPI</option>
            {% for b in bank %}
            <option value="{{b.name}}" data-account="{{ b.ac_no }}">
              {{b.name}}
            </option>
            {% endfor %}
          </select>
        </div>
      </div>
      <div class="form-group row mt-4" id="chequeField" style="display: none">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Cheque Number</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <input
            type="text"
            name="chequeId"
            id="chequeId"
            class="form-control bg-white text-dark"
            style="width: 550px; margin-left: 280px; margin-top: -35px"
          />
        </div>
      </div>

      <div class="form-group row mt-4" id="upiField" style="display: none">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>UPI ID</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <input
            type="text"
            name="upiNumber"
            id="upiNumber"
            class="form-control bg-white text-dark"
            style="width: 550px; margin-left: 280px; margin-top: -35px"
          />
        </div>
      </div>

      <div class="form-group row mt-4" id="bankField" style="display: none">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Bank Account</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <input
            type="text"
            name="bankAccount"
            id="bankAccount"
            class="form-control bg-white text-dark"
            style="width: 550px; margin-left: 280px; margin-top: -35px"
          />
        </div>
      </div> 

      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Vendor</label>
        <div class="col-sm-6">
          <div class="input-group" style="width: 550px">
            <select
              name="vendor"
              id="vendorSelect"
              class="form-control text-dark bg-light"
            >
              <option
                id="placeholderOption"
                value=""
                disabled
                class="text-dark bg-light"
                selected
              >
                Select a Vendor
              </option>
              {% for v in vendors %}

              <option
                value="{{ v.id }}"
                data-gst="{{ v.gst_treatment }}"
                data-pos="{{ v.source_supply }}"
              >
                {{ v.first_name }} {{ v.last_name }}
              </option>

              {% endfor %}
            </select>
            <div class="input-group">
              <button
                type="button"
                class="btn btn-outline-warning"
                data-toggle="modal"
                data-target="#newvendor"
                id="addVendorButton"
                style="height: 38px; margin-left: 560px; margin-top: -37px"
              >
                <b>+</b>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Vendor EmailId -->
      <div class="form-group row mt-4" id="emailid" style="display: none">
        <label for="email" class="col-sm-12 col-md-6 col-lg-3 col-form-label"
          >Vendor EmailId</label
        >
        <div class="col-sm-12 col-md-12 col-lg-6">
          <input
            type="text"
            class="form-control bg-white text-dark"
            id="vemail"
            name="vmail"
            style="width: 550px; color: black"
          />
        </div>
      </div>

      <!-- GST Treatment -->
      <div class="form-group row mt-4">
        <label class="col-sm-3 col-form-label">Vendor GST Treatment</label>
        <div class="col-sm-6">
          <input
            type="text"
            name="gst_trt_inp"
            id="gst_trt_inp"
            class="form-control bg-white text-dark"
            style="width: 550px; color: black"
          />
        </div>
      </div>

      <!-- Vendor GSTIN -->
      <div
        class="form-group row mt-4"
        id="textboxContainer"
        style="display: none"
      >
        <label class="col-sm-3 col-form-label" style="margin-top: 1rem"
          >Vendor GSTIN</label
        >
        <div class="col-sm-6">
          <input
            type="text"
            id="gst_num_inp"
            class="form-control bg-white text-dark"
            name="gstin_inp"
            placeholder="Enter additional information"
            value=""
            style="
              width: 550px;
              color: black;
              margin-left: 280px;
              margin-top: -2rem;
            "
          />
        </div>
      </div>
      
      <div class="form-group row">
        <label for="v_destination" class="col-sm-3 col-form-label">Vendor Destination of Supply</label>
        <div class="col-sm-6">
         
            <select name="destination" id="v_destination" class="form-control bg-white text-dark">
              
            {% comment %} <select name="destination" id="destination" class="form-control bg-white text-dark" style="margin-left: 6px; width: 547px;color:black;"> {% endcomment %}
              {% comment %} <option value="">Select a Place</option> {% endcomment %}
              {% for v in vendors %}
              
              <option value="{{v.source_supply}}">{{v.source_supply}}</option> 
              {% endfor %}
              <option value="[AN]-Andaman And Nicobar Islands" >[AN]-Andaman And Nicobar Islands</option>
              <option value="[AD]-Andhra Pradesh" >[AD]-Andhra Pradesh</option>
              <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh</option>
              <option value="[AS]-Assam" >[AS]-Assam</option>
              <option value="[BR]-Bihar" >[BR]-Bihar</option>
              <option value="[CH]-Chandhigarh" >[CH]-	Chandhigarh</option>
              <option value="[CG]-Chattisgarh" >[CG]-Chattisgarh</option>
              <option value="[DD]-Daman Diu" >[DD]-Daman Diu</option>
              <option value="[DL]-Delhi" >[DL]-	Delhi</option>
              <option value="[GA]-Goa" >[GA]-Goa</option>
              <option value="[GJ]-Gujarat" >[GJ]-Gujarat</option>
              <option value="[HR]-Haryana" >[HR]-Haryana</option>
              <option value="[HP]-Himachal Pradesh" >[HP]-Himachal Pradesh</option>
              <option value="[JK]-Jammu And Kashmir" >[JK]-Jammu And Kashmir</option>
              <option value="[JH]-Jharkand" >[JH]-Jharkand</option>
              <option value="[KA]-Karnataka" >[KA]-Karnataka</option>
              <option value="[KL]-Kerala" >[KL]-Kerala</option>
              <option value="[LA]-Ladakh" >[LA]-Ladakh</option>
              <option value="[LD]-Lakshadweep" >[LD]-Lakshadweep</option>
              <option value="[MP]-Madhyapradesh" >[MP]-Madhyapradesh</option>
              <option value="[MH]-Maharashtra" >[MH]-Maharashtra</option>
              <option value="[MN]-Manipur" >[MN]-Manipur</option>
              <option value="[ML]-Meghalaya" >[ML]-Meghalaya</option>
              <option value="[MZ]-Mizoram" >[MZ]-Mizoram</option>
              <option value="[NL]-Nagaland" >[NL]-Nagaland</option>
              <option value="[OD]-Odisha" >[OD]-Odisha</option>
              <option value="[PY]-Puducherry" >[PY]-Puducherry</option>
              <option value="[PB]-Punjab" >[PB]-Punjab</option>
              <option value="[RL]-Rajasthan" >[RL]-Rajasthan</option>
              <option value="[SK]-Sikkim" >[SK]-Sikkim</option>
              <option value="[TN]-Tamilnadu" >[TN]-Tamilnadu</option>
              <option value="[TS]-Telenghana" >[TS]-Telenghana</option>
              <option value="[TR]-Tripura" >[TR]-Tripura</option>
              <option value="[UP]-Uttar Pradesh" >[UP]-Uttar Pradesh</option>
              <option value="[UK]-Utharakhand" >[UK]-Utharakhand</option>
              <option value="[WB]-West Bengal" >[WB]-West Bengal</option>
              <option value="[OT]-Other Territory" >[OT]-Other Territory</option>
             
          </select>
         
           
      </div>
    </div>

      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Customer Name</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <div class="input-group" style="width: 555px">
            <select
              class="form-control bg-white text-dark"
              id="customer-list"
              name="customername"
            >
              <option value="">--Choose option--</option>
              {% for c in customers %}

              <option value="{{c.id}}" data-gst="{{ c.GSTTreatment }}">
                {{ c.customerName }}
              </option>
              {% endfor %}
            </select>
            <div class="input-group">
              <button
                class="btn btn-outline-warning"
                type="button"
                data-toggle="modal"
                data-target="#newcustomer"
                style="height: 38px; margin-left: 568px; margin-top: -37px"
              >
                <b>+</b>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="form-group row mt-4" id="emailField" style="display: block">
        <label for="email" class="col-sm-12 col-md-6 col-lg-3 col-form-label"
          >Customer EmailId</label
        >
        <div class="col-sm-12 col-md-12 col-lg-6">
          <input
            type="text"
            class="form-control bg-white text-dark"
            id="email"
            name="mail"
            style="
              width: 557px;
              margin-left: 275px;
              color: black;
              margin-top: -24px;
            "
          />
        </div>
      </div>
      <!-- GST Treatment -->
      <div class="form-group row mt-4" style="display: block">
        <label class="col-sm-3 col-form-label">Customer GST Treatment</label>
        <div class="col-sm-6">
          <input
            type="text"
            name="cu_gst_trt"
            id="cust_gst_trt"
            class="form-control bg-white text-dark"
            style="
              width: 555px;
              color: black;
              margin-left: 278px;
              margin-top: -25px;
            "
          />
        </div>
      </div>
      <div class="form-group row mt-4" id="gstContainer" style="display: none">
        <label class="col-sm-3 col-form-label" style="margin-top: 1rem"
          >Customer GSTIN</label
        >
        <div class="col-sm-6">
          <input
            type="text"
            id="cust_gst"
            class="form-control bg-white text-dark"
            name="cust_gstin"
            placeholder="Enter additional information"
            value=""
            style="width: 550px; color: black; margin-top: 1rem"
          />
        </div>
      </div>

      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Customer place of supply</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <input type="hidden" id="state" value="{{ company.state }}" />
          <select
            name="c_destination"
            id="c_destination"
            class="form-control bg-white text-dark"
            style="margin-left: -4px; width: 555px; color: black"
          >
            <option disabled selected>Select a Place</option>
            {% for c in customers %}
            <option value="{{c.placeofsupply}}">{{c.placeofsupply}}</option>
            {% endfor %}
            <option value="[AN]-Andaman And Nicobar Islands">
              [AN]-Andaman And Nicobar Islands
            </option>
            <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
            <option value="[AR]-Arunachal Pradesh">
              [AR]-Arunachal Pradesh
            </option>
            <option value="[AS]-Assam">[AS]-Assam</option>
            <option value="[BR]-Bihar">[BR]-Bihar</option>
            <option value="[CH]-	Chandhigarh">[CH]- Chandhigarh</option>
            <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
            <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
            <option value="[DL]-	Delhi">[DL]- Delhi</option>
            <option value="[GA]-Goa">[GA]-Goa</option>
            <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
            <option value="[HR]-Haryana">[HR]-Haryana</option>
            <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
            <option value="[JK]-Jammu And Kashmir">
              [JK]-Jammu And Kashmir
            </option>
            <option value="[JH]-Jharkand">[JH]-Jharkand</option>
            <option value="[KA]-Karnataka">[KA]-Karnataka</option>
            <option value="[KL]-Kerala">[KL]-Kerala</option>
            <option value="[LA]-Ladakh">[LA]-Ladakh</option>
            <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
            <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
            <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
            <option value="[MN]-Manipur">[MN]-Manipur</option>
            <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
            <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
            <option value="[NL]-Nagaland">[NL]-Nagaland</option>
            <option value="[NL]-Nagaland">[NL]-Nagaland</option>
            <option value="[OD]-Odisha">[OD]-Odisha</option>
            <option value="[PY]-Puducherry">[PY]-Puducherry</option>
            <option value="[PB]-Punjab">[PB]-Punjab.</option>
            <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
            <option value="[SK]-Sikkim">[SK]-Sikkim</option>
            <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
            <option value="[TS]-Telenghana">[TS]-Telenghana</option>
            <option value="[TR]-Tripura">[TR]-Tripura</option>
            <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
            <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
            <option value="[WB]-West Bengal">[WB]-West Bengal</option>
            <option value="[OT]-Other Territory">[OT]-Other Territory</option>
           
          </select>
        </div>
      </div>
      <div class="form-group row mt-4">
        <div class="row">
          <div class="col-md-3 col-form-label"><label>Tax</label></div>
          <div class="col-md-3">
            <select
              name="tax[]"
              id="tax1"
              class="form-control bg-light text-dark border-1 tax"
              onclick="checkTax()"
              style="margin-left: 4px; width: 550px; color: black"
            >
              <option value="" disabled selected>Select a Tax</option>
              <optgroup class="text-left" label="GST">
                <option value="GST0">0% GST(0%)</option>
                <option value="GST3">3.0% GST(3%)</option>
                <option value="GST5">5.0% GST(5%)</option>
                <option value="GST12">12.0% GST(12%)</option>
                <option value="GST18">18.0% GST(18%)</option>
                <option value="GST28">28.0% GST(28%)</option>
              </optgroup>
              <optgroup class="text-left" label="IGST">
                <option value="IGST0">0% IGST(0%)</option>
                <option value="IGST3">3.0% IGST(3%)</option>
                <option value="IGST5">5.0% IGST(5%)</option>
                <option value="IGST12">12.0% IGST(12%)</option>
                <option value="IGST18">18.0% IGST(18%)</option>
                <option value="IGST28">28.0% IGST(28%)</option>
              </optgroup>
            </select>
          </div>
        </div>
      </div>

      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label for="notes">Notes</label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-6">
          <input
            type="text"
            class="form-control bg-white text-dark"
            id="notes"
            name="notes"
            style="width: 550px"
          />
        </div>
      </div>

      <div class="form-group row mt-4">
        <div class="col-sm-12 col-md-3 col-lg-3 col-form-label">
          <label>Attach a File</label>
        </div>
        <div class="col-md-6 col-lg-6 col-sm-12 py-3 text-center rounded mt-4">
          <div
            style="
              width: 103%;
              background-color: rgba(243, 241, 241, 0.904);
              height: 50px;
              margin-left: -0.2rem;
              margin-top: -40px;
            "
          >
            <label class="text-black mt-1 pt-0" for=""
              >Attach File(s) to Recurring Expense</label
            ><br />

            <label
              for="file-upload"
              class="btn text-white border-0"
              style="background-color: rgb(210, 132, 30)"
            >
              <i class="fas fa-upload text-white"></i>
              <span id="file-label">Upload File</span>
            </label>
            <input
              class="pb-3"
              id="file-upload"
              type="file"
              name="file"
              style="display: none"
            />
          </div>
        </div>
      </div>
      <div class="form-group" style="margin-left: 80px; margin-top: 100px">
        <button
          type="submit"
          class="btn btn-warning"
          style="width: 100px"
          onclick="saveDialog()"
        >
          Save</button
        >&nbsp;&nbsp;
        <button
          type="submit"
          class="btn btn-warning"
          style="width: 100px; height: 35px"
          onclick="draftDialog()"
        >
          Draft</button
        >&nbsp;&nbsp;
        <button
          type="button"
          class="btn btn-warning"
          onclick="clearForm()"
          style="color: orangered; width: 100px; height: 35px"
          id="clearButton"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div> 

 <script>
  document.getElementById("clearButton").addEventListener("click", clearForm);

  function clearForm() {
    document.getElementById("expenseForm").reset();
  }
</script>

 <script>
  // JavaScript to update the account number based on the selected bank
  document
    .getElementById("paidthrough")
    .addEventListener("change", function () {
      var selectedBank = this.value;
      var accountNumberInput = document.getElementById("bankAccount");

      // Find the selected option and get the associated account number
      var selectedOption = this.options[this.selectedIndex];
      var accountNumber = selectedOption.getAttribute("data-account");

      // Update the account number input field
      accountNumberInput.value = accountNumber;
    });
</script> 

<script>
  var paidthroughSelect = document.getElementById("paidthrough");
  var chequeField = document.getElementById("chequeField");
  var upiField = document.getElementById("upiField");
  var bankField = document.getElementById("bankField");

  paidthroughSelect.addEventListener("change", function () {
    var selectedOption = paidthroughSelect.value;

    chequeField.style.display = selectedOption === "Cheque" ? "block" : "none";
    upiField.style.display = selectedOption === "UPI" ? "block" : "none";
    bankField.style.display =
      selectedOption !== "Cash" &&
      selectedOption !== "Cheque" &&
      selectedOption !== "UPI"
        ? "block"
        : "none";
  });
</script> 

<script>
  function saveDialog() {
    var frm = document.getElementById("expenseForm");
    frm.action = "{% url 'add_expense' %}";
  }

  function draftDialog() {
    var frm = document.getElementById("expenseForm");
    frm.action = "{% url 'draft_expense' %}";
  }
  $(document).ready(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });
</script> 

{% comment %} <script>
  // Get references to the input elements
  var startDateInput = document.getElementById("start_date");
  var endsOnInput = document.getElementById("ends_on");

  // Listen for changes in the "Start Date" input
  startDateInput.addEventListener("change", function () {
    // Parse the selected date
    var selectedStartDate = new Date(startDateInput.value);

    // Calculate the date one day after the selected "Start Date"
    var oneDayAfterStartDate = new Date(selectedStartDate);
    oneDayAfterStartDate.setDate(selectedStartDate.getDate() + 1);

    // Format the date in yyyy-mm-dd for setting as min
    var formattedDate = oneDayAfterStartDate.toISOString().split("T")[0];

    // Update the "Ends On" input's min attribute
    endsOnInput.min = formattedDate;
  });
</script>  {% endcomment %}

 <script>
  $(document).ready(function () {
    $("#vendorSelect").on("change", function () {
      var selectedVendorId = $(this).val();
  
      if (selectedVendorId !== "") {
        // First, get vendor GST information
        $.ajax({
          url: "/get_vendor_gst/" + selectedVendorId,
          method: "GET",
          success: function (data) {
            $("#gst_trt_inp").val(data.gst_treatment);
            $("#vemail").val(data.email);
            $("#emailid").show();
            $("#v_destination").val(data.source_supply);
  
            // Update the destination field with the source_supply information
            if (data.gst_treatment.toLowerCase().includes("unregistered business")) {
              $("#textboxContainer").hide();
            } else {
              $("#textboxContainer").show();
              $("#gst_num_inp").val(data.gst_number);
  
              // Chain the AJAX request for vendor place of supply information
              getVendorPlaceOfSupply(selectedVendorId);
            }
          },
          error: function (error) {
            console.log("Error fetching GST data:", error);
          },
        });
      } else {
        // Clear the input fields and hide the GST number input field if no vendor is selected
        resetFields();
      }
    });
  
    // Function to reset input fields and hide containers
    function resetFields() {
      $("#gst_trt_inp, #gst_num_inp, #vemail, #v_destination").val("");
      $("#textboxContainer").hide();
      $("#emailid").hide();
    }
  
    // Function to get vendor place of supply information
    
  });
  
</script> 

<script type="text/javascript">
  $(document).ready(function () {
    $("#customer-list").change(function () {
      var customer_id = $(this).val();
      if (customer_id) {
        // Make an AJAX request to get the customer's email
        $.get('{% url "get_customer_email" %}', { customername: customer_id })
          .then(function (data) {
            $("#email").val(data.email);

            // Make an AJAX request to get the customer's GST treatment
            
          })
          .catch(function (error) {
            console.log("Error fetching customer details:", error);
          });
      }
    });
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $("#customer-list").change(function () {
      var customer_id = $(this).val();
      if (customer_id) {
        // Make an AJAX request to get the customer's GST treatment
        $.get('{% url "get_customer_gsttrmnt" %}', { customername: customer_id })
          .then(function (data) {
            console.log('pos', data.pos);
            $("#cust_gst_trt").val(data.gst_trtmnt);
            $("#cust_gst").val(data.gstin);
            $("#c_destination").val(data.pos);

            // Check the GST treatment and show/hide the input field
            if (data.gst_trtmnt.toLowerCase().includes("unregistered business")) {
              $("#gstContainer").hide();
            } else {
              $("#gstContainer").show();
            }
          })
          .catch(function (error) {
            console.log("Error fetching customer details:", error);
          });
      }
    });
  });
</script>



<script type="text/javascript">
  $(document).ready(function () {
    checkTax();
    $("#c_destination").change(function () {
      checkTax();
    });
  });

  function checkTax() {
    // Get the selected place of supply
    var placeOfSupply = $("#c_destination")
      .val()
      .split("-")
      .slice(1)
      .join(" ")
      .trim();

    // Get the company's state and convert it to lowercase
    var companyState = $("#state").val().toLowerCase();

    // Convert the placeOfSupply to lowercase for consistent comparison
    placeOfSupply = placeOfSupply.toLowerCase();

    // Get the tax dropdown element
    var taxDropdown = document.getElementById("tax1");

    // Store the currently selected value
    var selectedValue = $("#tax1").val();

    // Remove all options from the dropdown
    $("#tax1").empty();

    // Add the default "Select" option back to the dropdown
    $("#tax1").append("<option value=''>Select</option>");

    // Get the optgroup elements inside the tax dropdown
    var gstOptgroup = $("<optgroup label='GST'></optgroup>");
    var igstOptgroup = $("<optgroup label='IGST'></optgroup>");

    // Add options to the optgroups based on the condition
    if (placeOfSupply === "kerala" && companyState === "kerala") {
      // If both company state and customer place of supply are Kerala, add GST options
      gstOptgroup.append(" <option value='GST0'>0% GST(0%)</option>");
      gstOptgroup.append(" <option value='GST3'>3.0% GST(3%)</option>");
      gstOptgroup.append("<option value='GST5'>5.0% GST(5%)</option>");
      gstOptgroup.append("<option value='GST12'>12.0% GST(12%)</option>");
      gstOptgroup.append("<option value='GST18'>18.0% GST(18%)</option>");
      gstOptgroup.append(" <option value='GST28'>28.0% GST(28%)</option>");
      $("#tax1").append(gstOptgroup);

      // Select the previously selected value, if any
      $("#tax1").val(selectedValue);
    } else {
      // If any other condition, add IGST options

      igstOptgroup.append(" <option value='IGST0'>0% IGST(0%)</option>");
      igstOptgroup.append(" <option value='IGST3'>3.0% IGST(3%)</option>");
      igstOptgroup.append(" <option value='IGST5'>5.0% IGST(5%)</option>");
      igstOptgroup.append(" <option value='IGST12'>12.0% IGST(12%)</option>");
      igstOptgroup.append(" <option value='IGST18'>18.0% IGST(18%)</option>");
      igstOptgroup.append(" <option value='IGST28'>28.0% IGST(28%)</option>");
      $("#tax1").append(igstOptgroup);

      // Select the previously selected value, if any
      $("#tax1").val(selectedValue);
    }
  }
</script> 



 <script>

  $(document).ready(function() {
    $('#accountSave').click(function() {
      var accountType = $('#accountType').val();
      var accountName = $('#accountName').val();
      var accountCode = $('#accountCode').val();
      var description = $('#description').val();

      // Prepare the data to be sent as JSON
      var data = {
        accountType: accountType,
        accountName: accountName,
        accountCode: accountCode,
        description: description,
        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()  // Include the CSRF token
      };

      $.ajax({
        url: '{% url 'save_recurring_data' %}',
        type: 'POST',
        data: data,
        dataType: 'json',  // Expect JSON response
        success: function(response) {
          $("#accountForm")[0].reset();
          updateDropdown(response);
          console.log('Data saved successfully');
        },
        error: function(error) {
          console.error('Error saving data:', error);
        }
      });
    });
  });

  function updateDropdown(response) {
    var expenseAccountDropdown = $("#expense_account");
    var accountType = response.account_type;
    var accountName = response.account_name;
    var accountId = response.acc_id;

    var optgroup = expenseAccountDropdown.find("optgroup[label='" + accountType + "']");
    if (optgroup.length === 0) {
      optgroup = $("<optgroup>").attr("label", accountType);
      expenseAccountDropdown.append(optgroup);
    }

    var existingOption = optgroup.find("option:contains('" + accountName + "')");

    if (existingOption.length === 0) {
      var newOption = $("<option>").val(accountId).text(accountName);
      optgroup.append(newOption);
    }
  }
</script> 

<!--Add Newcustomer -->

 <div class="modal fade" id="newcustomer">
  <div class="modal-dialog modal-xl">
    <div
      class="modal-content"
      style="background: rgb(32, 35, 37); border-radius: 20px"
    >
      <div class="modal-header" style="background: rgb(32, 35, 37)">
        <h3 class="m-3 text-uppercase">New Customer</h3>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37)">
        <div class="card p-3 m-3">
          <form
            action=""
            method="post"
            class="needs-validation"
            novalidate
            autocomplete="off"
            id="customerForm"
          >
            {% csrf_token %}
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="">Customer Type</label><br />
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input
                      type="radio"
                      id="business"
                      name="radioCust"
                      value="Business"
                    />
                    <label for="option1">Business</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input
                      type="radio"
                      id="individual"
                      name="radioCust"
                      value="Individual"
                    />
                    <label for="option2">Individual</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-3">
                <label for="ctitle">Title</label>
              </div>
              <div class="col-md-3">
                <select
                  name="ctitle"
                  id="ctitle"
                  class="form-control bg-light text-dark"
                >
                  <option value="Mr." selected>Mr.</option>
                  <option value="Mrs.">Mrs.</option>
                  <option value="Ms.">Ms.</option>
                  <option value="Miss.">Miss.</option>
                  <option value="Dr.">Dr.</option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cfname">First name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="cfname"
                  name="cfirstname"
                  required
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="clname">Last name</label>
                <label id="cdisplayname" name="cdisplayname" hidden></label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="clname"
                  name="clastname"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="ccompany">Company Name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="ccompany"
                  name="ccompany_name"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cemail">Customer Email</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="email"
                  class="form-control bg-light text-dark"
                  id="cemail"
                  name="cemail"
                  placeholder="example@gmail.com"
                  pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="email">Customer Phone</label>
              </div>
              <div class="col-md-3 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="cw_mobile"
                  placeholder="Work Number"
                  maxlength="10"
                  name="cw_mobile"
                />
              </div>
              <div class="col-md-3 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="cp_mobile"
                  placeholder="Personal Number"
                  maxlength="10"
                  name="cp_mobile"
                />
              </div>
            </div>
            <hr />
            <center>
              <h4 class="text-uppercase mb-3"><b>Other Details</b></h4>
            </center>
            <div class="row mt-5">
              <div class="col-md-3 mt-2">
                <label for="facebook">Facebook</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="facebook"
                  placeholder="www.example.com"
                  name="facebook"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="twitter">Twitter</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="twitter"
                  placeholder="www.example.com"
                  name="twitter"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="website">Website</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="website"
                  placeholder="www.example.com"
                  name="website"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cskype">Skype name/Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="cskype"
                  name="cskype"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_desg">Designation</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="c_desg"
                  name="c_desg"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_dpt">Department</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="c_dpt"
                  name="c_dpt"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_gsttype" style="color: rgb(190, 88, 88)"
                  >GST Treatment *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <select
                  class="form-control bg-light text-dark"
                  id="c_gsttype"
                  name="c_gsttype"
                  required
                >
                  <option value="value" selected hidden>
                    Select a Gst Treatment
                  </option>
                  <option
                    value="Registered Business-Regular Business that is registered under GST"
                  >
                    Registered Business-Regular Business that is registered
                    under GST
                  </option>
                  <option
                    value="Registered Business-Composition Business that is registered under the Composition scheme in GST"
                  >
                    Registered Business-Composition Business that is registered
                    under the Composition scheme in GST
                  </option>
                  <option
                    value="Unregistered Business-not Registered under GST"
                  >
                    Unregistered Business-not Registered under GST
                  </option>
                  <option
                    value="Consumer- A customer who is a regular Consumer"
                  >
                    Consumer- A customer who is a regular Consumer
                  </option>
                  <option
                    value="Overseas- Persons with who you do import or exports of supplies outside india"
                  >
                    Overseas- Persons with who you do import or exports of
                    supplies outside india
                  </option>
                  <option value="Special Economic Zone">
                    Special Economic Zone
                  </option>
                </select>
              </div>
            </div>
            <div class="row gstroww d-none">
              <div class="col-md-3 mt-2">
                <label id="glbl" style="color: rgb(190, 88, 88)"
                  >GSTIN/UIN *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="c_gstin"
                  name="c_gstin"
                  placeholder="29APPCK7465F1Z1"
                />
                <label id="gst_labell"></label>
              </div>
            </div>
            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="c_pan">PAN Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark"
                  id="c_pan"
                  name="c_pan"
                  placeholder="APPCK7465F"
                />
                <label id="pan_label" style="display: none"></label>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="" style="color: rgb(190, 88, 88)"
                  >Place of Supply *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <select
                  class="form-control bg-light text-dark"
                  id="placesupply"
                  name="placesupply"
                >
                  <option value="Nill" hidden></option>
                  <option value="[AN]-Andaman And Nicobar Islands">
                    [AN]-Andaman And Nicobar Islands
                  </option>
                  <option value="[AD]-Andhra Pradesh">
                    [AD]-Andhra Pradesh
                  </option>
                  <option value="[AR]-Arunachal Pradesh">
                    [AR]-Arunachal Pradesh
                  </option>
                  <option value="[AS]-Assam">[AS]-Assam</option>
                  <option value="[BR]-Bihar">[BR]-Bihar</option>
                  <option value="[CH]-	Chandhigarh">[CH]- Chandhigarh</option>
                  <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                  <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                  <option value="[DL]-	Delhi">[DL]- Delhi</option>
                  <option value="[GA]-Goa">[GA]-Goa</option>
                  <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                  <option value="[HR]-Haryana">[HR]-Haryana</option>
                  <option value="[HP]-Himachal Pradesh">
                    [HP]-Himachal Pradesh
                  </option>
                  <option value="[JK]-Jammu And Kashmir">
                    [JK]-Jammu And Kashmir
                  </option>
                  <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                  <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                  <option value="[KL]-Kerala">[KL]-Kerala</option>
                  <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                  <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                  <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                  <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                  <option value="[MN]-Manipur">[MN]-Manipur</option>
                  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                  <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                  <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                  <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                  <option value="[OD]-Odisha">[OD]-Odisha</option>
                  <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                  <option value="[PB]-Punjab">[PB]-Punjab.</option>
                  <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                  <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                  <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                  <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                  <option value="[TR]-Tripura">[TR]-Tripura</option>
                  <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                  <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                  <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                  <option value="[OT]-Other Territory">
                    [OT]-Other Territory
                  </option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3">
                <label for="c_tax" style="color: rgb(190, 88, 88)"
                  >Tax Preference *
                </label>
              </div>
              <div class="col-md-6">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input
                      type="radio"
                      id="item-tax3"
                      name="radioOption2"
                      value="Taxable"
                    />
                    <label for="option3">Taxable</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input
                      type="radio"
                      id="item-tax4"
                      name="radioOption2"
                      value="Tax-exempt"
                    />
                    <label for="option4">Tax-exempt</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-2 mb-4 d-none inter-intra">
              <div class="col-md-3">
                <label for="intra">Intra-State TAX</label>
              </div>
              <div class="col-md-6">
                <select
                  name="intra"
                  class="form-control bg-light text-dark"
                  id="intra1"
                >
                  <option value="" hidden>Select GST</option>
                  <option value="GST0[0%]">GST0[0%]</option>
                  <option value="GST5[5%]">GST5[5%]</option>
                  <option value="GST12[12%]">GST12[12%]</option>
                  <option value="GST18[18%]">GST18[18%]</option>
                  <option value="GST28[28%]">GST28[28%]</option>
                </select>
              </div>
              <div class="col-md-3"></div>
              <div class="col-md-3">
                <label for="inter">Inter-State TAX</label>
              </div>
              <br />
              <div class="col-md-6">
                <select
                  name="inter"
                  class="form-control bg-light text-dark"
                  id="inter1"
                >
                  <option value="" hidden>Select GST</option>
                  <option value="IGST0[0%]">IGST0[0%]</option>
                  <option value="IGST5[5%]">IGST5[5%]</option>
                  <option value="IGST12[12%]">IGST12[12%]</option>
                  <option value="IGST18[18%]">IGST18[18%]]</option>
                  <option value="IGST28[28%]">IGST28[28%]</option>
                </select>
              </div>
              <div class="col-md-1"></div>
            </div>
            <hr />
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_curn">Currency </label>
              </div>
              <div class="col-md-3 mt-2">
                <select
                  class="form-control bg-light text-dark"
                  id="c_curn"
                  name="c_curn"
                  required
                >
                  <option selected disabled value="" hidden>Choose..</option>
                  <option value="INR">INR</option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_open">Opening Balance</label>
              </div>
              <div class="col-md-6 mt-2 d-flex">
                <select
                  name="bal"
                  id="bal"
                  style="width: 35%; height: 97%"
                  class="form-gr form-select text-dark bg-light"
                >
                  <option value="credit">Credit</option>
                  <option value="debit">Debit</option>
                </select>
                <input
                  type="text"
                  class="form-control bg-light text-dark"
                  id="c_open"
                  name="c_open"
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_terms">Payment Terms</label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <select
                    class="form-control bg-light text-dark"
                    id="c_terms"
                    name="c_terms"
                    required
                  >
                    {% for p in pay %}
                    <option value="{{p.Terms}} {{p.id}}">{{p.Terms}}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
            </div>
            <hr />
            <div class="row mt-2">
              <div class="col-md-6 mt-5 text-center text-uppercase">
                <h4 class="mb-0">Billing Address</h4>
              </div>
              <div class="col-md-6 mt-5">
                <h4 class="mb-0 text-center text-uppercase">
                  Shipping Address
                </h4>
              </div>
            </div>
            <div class="row mt-2 m-0 p-0 mb-2">
              <div class="col-md-9"></div>
              <div class="col-md-3 text-right m-0 p-0">
                <input
                  type="checkbox"
                  onclick="address()"
                  id="csokay"
                  name="csokay"
                />
                <label for="csokay" style="color: #909091"
                  >Same As Billing Address</label
                >
              </div>
            </div>

            <div class="row mt-5">
              <div class="col-md-1">
                <label for="cstreet1">Address 1</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="cstreet1"
                  name="cstreet1"
                ></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstreet1">Address 1</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="csstreet1"
                  name="csstreet1"
                ></textarea>
              </div>
              <div class="col-md-1"></div>
            </div>
            <div class="row mt-5">
              <div class="col-md-1">
                <label for="cstreet2">Address 2</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="cstreet2"
                  name="cstreet2"
                ></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstreet2">Address 2</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="csstreet2"
                  name="csstreet2"
                ></textarea>
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccity">City</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="ccity"
                  name="ccity"
                  placeholder="City"
                />
              </div>
              <div class="col-md-1"></div>
              <div class="col-md-1">
                <label for="cscity">City</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cscity"
                  name="cscity"
                  placeholder="City"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cstate">State</label>
              </div>
              <div class="col-md-4">
                <select
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cstate"
                  name="cstate"
                >
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">
                    Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">
                    Dadra and Nagar Haveli
                  </option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstate">State</label>
              </div>
              <div class="col-md-4">
                <select
                  type="text"
                  class="form-control text-dark bg-light"
                  id="csstate"
                  name="csstate"
                >
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">
                    Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">
                    Dadra and Nagar Haveli
                  </option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>

              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccountry">Country</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="ccountry"
                  name="ccountry"
                  placeholder="Country"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cscountry">Country</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cscountry"
                  name="cscountry"
                  placeholder="Country"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cpincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cpincode"
                  name="cpincode"
                  maxlength="6"
                  placeholder="PIN Code"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cspincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cspincode"
                  name="cspincode"
                  maxlength="6"
                  placeholder="PIN Code"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cphone"
                  name="cphone"
                  placeholder="Phone"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="csphone"
                  name="csphone"
                  placeholder="Phone"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="cfax"
                  name="cfax"
                  placeholder="FAX"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="csfax"
                  name="csfax"
                  placeholder="FAX"
                />
              </div>
              <div class="col-md-1"></div>
            </div>
            <div class="row mt-2">
              <div class="col-md-6">
                <input
                  type="checkbox"
                  value=""
                  id="invalidCheck"
                  name="invalidCheck"
                  required
                />
                <label for="invalidCheck" style="color: #909091"
                  >Agree to terms and conditions</label
                >
                <div class="invalid-feedback text-warning">
                  You must agree before submitting.
                </div>
              </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button
                    class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="submit"
                    data-dismiss="modal"
                    id="addCustomerButton"
                  >
                    Submit
                  </button>
                  <button
                    type="button"
                    class="close btn save_btn rounded-pill text-grey w-50 my-4"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 
<!--End Cutomer-->

 <script>
  $(document).ready(function () {
    $("#cfname, #clname").change(function () {
      // Assuming #title is an input field containing a title (e.g., Mr., Mrs., etc.)
      var title = $("#ctitle").val() || ""; // Use an empty string if title is not provided
      var firstName = $("#cfname").val() || "";
      var lastName = $("#clname").val() || "";
      var fullName = title + " " + firstName + " " + lastName;
      $("#cdisplayname").val(fullName);
      console.log(fullName);
    });
  });
</script> 

<!-- Include jQuery library -->
<!--<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
 <script>
  $(document).ready(function () {
    // Initial update of the customer dropdown list on page load
    updateCustomerDropdown();

    // Handle clicking the "Add Customer" button in the modal
    $("#addCustomerButton").on("click", function () {
      var formData = $("#customerForm").serialize();

      $.ajax({
        url: "{% url 'entr_recurring_custmr' %}",
        type: "POST",
        data: formData,
        success: function (data) {
          // Clear the form fields
          $("#customerForm")[0].reset();

          // Close the modal
          $("#newcustomer").modal("hide");

          // Update the customer dropdown list
          updateCustomerDropdown(data); // Pass the data object as a parameter
        },
        error: function (error) {
          console.log("Error:", error);
        },
      });
    });

    // Function to update the customer dropdown list
    function updateCustomerDropdown(formData) {
      var customerListSelect = $("#customer-list");

      $.ajax({
        url: "{% url 'get_customer_namess' %}",
        type: "GET",
        success: function (data) {
          customerListSelect.empty();

          // Add the default option
          customerListSelect.append(
            "<option value=''>--Choose option--</option>"
          );

          // Add existing customers
          data.forEach(function (customer) {
            customerListSelect.append(
              "<option value='" +
                customer.id +
                "'>" +
                customer.name +
                "</option>"
            );
          });

          // Check if formData is defined and not already in the dropdown
          if (
            formData &&
            formData.id &&
            formData.name &&
            !customerExists(formData.id)
          ) {
            // Append the newly added customer
            customerListSelect.append(
              "<option value='" +
                formData.id +
                "'>" +
                formData.name +
                "</option>"
            );

            // Update the form fields based on the selected customer
            updateFormFields(formData.id);
          }

          // Listen for the change event on the customer dropdown
          customerListSelect.on("change", function () {
            var selectedCustomerId = $(this).val();
            updateFormFields(selectedCustomerId);
          });
        },
        error: function (error) {
          console.log("Error:", error);
        },
      });
    }

    // Function to check if a customer with the given ID already exists in the dropdown
    function customerExists(customerId) {
      return $("#customer-list option[value='" + customerId + "']").length > 0;
    }

    // Function to update form fields based on the selected customer
    function updateFormFields(customerId) {
      // Check if customerId is defined before making the AJAX call
      if (customerId) {
        // Add logic to fetch details for the selected customer and update form fields
        $.ajax({
          url: "{% url 'get_customer_email' %}",
          type: "GET",
          data: { customer_id: customerId },
          success: function (data) {
            // Assuming data is an object containing customer details
            // Update the form fields with the fetched details
            $("#customer-list").val(data.name);
            $("#emailField").val(data.email);

            // Trigger change event to update other fields
            $("#customer-list").change();
          },
          error: function (error) {
            console.log("Error fetching customer details:", error);
          },
        });
      } else {
        // Handle the case where customerId is undefined (e.g., no customer selected)
        // You might want to clear or reset the form fields in this case
      }
    }
  });
</script>

 <div class="modal fade" id="newAccountModal">
  <!-- Modal content here -->
  <div class="modal-dialog modal-xl">
    <div
      class="modal-content"
      style="background: rgb(32, 35, 37); border-radius: 20px"
    >
      <div class="modal-header" style="background: rgb(32, 35, 37)">
        <h3 class="m-3 text-uppercase">New Account</h3>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37)">
        <div class="card p-3 m-3">
          <form
            action="{% url 'save_recurring_data' %}"
            method="post"
            class="needs-validation"
            novalidate
            autocomplete="off"
            id="accountForm"
          >
            {% csrf_token %}
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="accountType">Account Type:</label>
                <select
                  class="form-control text-dark"
                  id="accountType"
                  name="accountType"
                >
                  <option value="" disabled>Select an option</option>
                  <optgroup label="Assets">
                    <option value="Other Current Asset">
                      Other Current Asset
                    </option>
                    <option value="Cash">Cash</option>
                    <option value="Bank">Bank</option>
                    <option value="Stock">Stock</option>
                    <option value="Payment Clearing">Payment Clearing</option>
                    <option value="Fixed Asset">Fixed Asset</option>
                  </optgroup>
                  <optgroup label="Liability">
                    <option value="Other Liability">Other Liability</option>
                    <option value="Other Current Liability">
                      Other Current Liability
                    </option>
                    <option value="Credit Card">Credit Card</option>
                    <option value="Long Term Liability">
                      Long Term Liability
                    </option>
                    <option value="Overseas Tax Payable">
                      Overseas Tax Payable
                    </option>
                  </optgroup>
                  <optgroup label="Expense">
                    <option value="Expenses">Expenses</option>
                    <option value="Cost Of Goods Sold">
                      Cost Of Goods Sold
                    </option>
                    <option value="Other Expense">Other Expense</option>
                  </optgroup>
                  <optgroup label="Equity">
                    <option value="Equity">Equity</option>
                  </optgroup>
                  <optgroup label="Income">
                    <option value="Income">Income</option>
                    <option value="Other Income">Other Income</option>
                  </optgroup>
                </select>
              </div>
              <div class="form-group col-md-6">
                <label for="accountName">Account Name:</label>
                <input
                  type="text"
                  class="form-control text-dark"
                  id="accountName"
                  name="accountName"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="accountCode">Account Code:</label>
                <input
                  type="text"
                  class="form-control text-dark"
                  id="accountCode"
                  name="accountCode"
                  required
                />
              </div>
              <div class="form-group col-md-6">
                <label for="description">Description:</label>
                <textarea
                  class="form-control text-dark"
                  id="description"
                  name="description"
                  rows="3"
                  required
                ></textarea>
              </div>
            </div>

            <div class="form-row mt-3">
              <div class="col-md-6">
                <button
                  type="submit"
                  class="btn btn-primary"
                  id="accountSave"
                  data-dismiss="modal"
                >
                  Save and Select
                </button>
                <button
                  type="button"
                  class="close btn btn-secondary"
                  data-dismiss="modal"
                  aria-label="Close"
                  style="height: 35px"
                >
                  <span aria-hidden="true">Cancel</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 

<div
  class="modal fade"
  id="newvendor"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalLabel1"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl" role="document">
    <div
      class="modal-content"
      style="background: rgb(32, 35, 37); border-radius: 20px"
    >
      <div class="modal-header" style="background: rgb(32, 35, 37)">
        <h3 class="modal-title m-3 text-uppercase" id="exampleModalLabel">
          New Vendor
        </h3>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="card p-3 m-3">
          <form
            action=""
            method="post"
            class="needs-validation"
            novalidate
            id="vendorForm"
          >
            {% csrf_token %}

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="validationCustom01">Title</label>
              </div>
              <div class="col-md-3 mt-2">
                <select
                  name="title"
                  id="title"
                  class="form-control text-dark bg-light"
                >
                  <option value="Mr.">Mr.</option>
                  <option value="Mrs.">Mrs.</option>
                  <option value="Miss">Miss.</option>
                  <option value="Ms.">Ms.</option>
                </select>
              </div>
            </div>
            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="fname">First name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="fname"
                  name="firstname"
                  required
                />
              </div>
            </div>
            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="lname">Last name</label>
                <label id="vdisplayname" name="vdisplayname" hidden></label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="lname"
                  name="lastname"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="company">Company Name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vcompany"
                  name="vcompany_name"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="email">Email</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="email"
                  class="form-control text-dark bg-light"
                  id="vemail"
                  name="vemail"
                  placeholder="example@gmail.com"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="email">Vendor Phone</label>
              </div>
              <div class="col-md-3 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vw_mobile"
                  placeholder="Work Number"
                  maxlength="10"
                  name="vw_mobile"
                />
              </div>
              <div class="col-md-3 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vp_mobile"
                  placeholder="Personal Number"
                  maxlength="10"
                  name="vp_mobile"
                />
              </div>
            </div>

            <hr />
            <center>
              <h4 class="text-uppercase mb-3"><b>Other Details</b></h4>
            </center>

            <div class="row mt-5">
              <div class="col-md-3 mt-2">
                <label for="wsite">Website</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="wsite"
                  placeholder="www.example.com"
                  name="website"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="vskype">Skype name/Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vskype"
                  name="vskype"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_desg">Designation</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="v_desg"
                  name="v_desg"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_dpt">Department</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="v_dpt"
                  name="v_dpt"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_gsttype" style="color: rgb(190, 88, 88)"
                  >GST Treatment *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <select
                  class="form-control text-dark bg-light"
                  id="v_gsttype"
                  name="v_gsttype"
                  required
                >
                  <option selected disabled value="">Choose..</option>
                  <option value="Registered Business - Regular">
                    Registered Business - Regular
                    <span><i>(Business that is registered under gst)</i></span>
                  </option>
                  <option value="Registered Business - Composition">
                    Registered Business - Composition (Business that is
                    registered under composition scheme in gst)
                  </option>
                  <option value="unregistered Business">
                    Unregistered Business (Business that has not been registered
                    under gst)
                  </option>
                  <option value="Overseas">
                    Overseas (Import/Export of supply outside india)
                  </option>
                  <option value="Special Economic Zone (SEZ)">
                    Special Economic Zone (SEZ) (Business that is located in a
                    special economic zone of india or a SEZ developer)
                  </option>
                  <option value="Demed Exports">
                    Demed Exports (Supply of woods to an exports oriented unit
                    or againsed advanced authorization or export promotion
                    capital woods)
                  </option>
                  <option value="Tax Deductor">
                    Tax Deductor (State of central gov,government agencies or
                    local authority)
                  </option>
                  <option value="SEZ Developer">
                    SEZ Developer (A person or organization who owns atleast 26%
                    eqaulity in creating business units in special economic
                    zone)
                  </option>
                </select>
              </div>
            </div>
            <div class="row gstrow d-none">
              <div class="col-md-3 mt-2">
                <label id="glbl" style="color: rgb(190, 88, 88)"
                  >GSTIN/UIN *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="v_gstin"
                  name="v_gstin"
                  placeholder="29APPCK7465F1Z1"
                />
                <label id="gst_label"></label>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_pan">PAN Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="v_pan"
                  name="v_pan"
                  placeholder="APPCK7465F"
                />
                <label id="pan_label"></label>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="" style="color: rgb(190, 88, 88)"
                  >Source of Supply *</label
                >
              </div>
              <div class="col-md-6 mt-2">
                <select
                  class="form-control text-dark bg-light"
                  id="v_srcsupply"
                  name="v_sourceofsupply"
                >
                  <option value="Nill"></option>
                  <option value="[AN]-Andaman And Nicobar Islands">
                    [AN]-Andaman And Nicobar Islands
                  </option>
                  <option value="[AD]-Andhra Pradesh">
                    [AD]-Andhra Pradesh
                  </option>
                  <option value="[AR]-Arunachal Pradesh">
                    [AR]-Arunachal Pradesh
                  </option>
                  <option value="[AS]-Assam">[AS]-Assam</option>
                  <option value="[BR]-Bihar">[BR]-Bihar</option>
                  <option value="[CH]-	Chandhigarh">[CH]- Chandhigarh</option>
                  <option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                  <option value="[DD]-Daman Diu">[DD]-Daman Diu</option>
                  <option value="[DL]-	Delhi">[DL]- Delhi</option>
                  <option value="[GA]-Goa">[GA]-Goa</option>
                  <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                  <option value="[HR]-Haryana">[HR]-Haryana</option>
                  <option value="[HP]-Himachal Pradesh">
                    [HP]-Himachal Pradesh
                  </option>
                  <option value="[JK]-Jammu And Kashmir">
                    [JK]-Jammu And Kashmir
                  </option>
                  <option value="[JH]-Jharkand">[JH]-Jharkand</option>
                  <option value="[KA]-Karnataka">[KA]-Karnataka</option>
                  <option value="[KL]-Kerala">[KL]-Kerala</option>
                  <option value="[LA]-Ladakh">[LA]-Ladakh</option>
                  <option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                  <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option>
                  <option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                  <option value="[MN]-Manipur">[MN]-Manipur</option>
                  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                  <option value="[MZ]-Mizoram">[MZ]-Mizoram</option>
                  <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                  <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                  <option value="[OD]-Odisha">[OD]-Odisha</option>
                  <option value="[PY]-Puducherry">[PY]-Puducherry</option>
                  <option value="[PB]-Punjab">[PB]-Punjab.</option>
                  <option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                  <option value="[SK]-Sikkim">[SK]-Sikkim</option>
                  <option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                  <option value="[TS]-Telenghana">[TS]-Telenghana</option>
                  <option value="[TR]-Tripura">[TR]-Tripura</option>
                  <option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                  <option value="[UK]-Utharakhand">[UK]-Utharakhand</option>
                  <option value="[WB]-West Bengal">[WB]-West Bengal</option>
                  <option value="[OT]-Other Territory">
                    [OT]-Other Territory
                  </option>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_curn">Currency </label>
              </div>
              <div class="col-md-3 mt-2">
                <select
                  class="form-control text-dark bg-light"
                  id="v_curn"
                  name="currency"
                  required
                >
                  <option selected disabled value="">Choose..</option>
                  <option value="INR">INR</option>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_open">Opening Balance</label>
              </div>
              <div class="col-md-6 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="v_open"
                  name="v_open"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_terms">Payment Terms</label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <select
                    class="form-control text-dark bg-light"
                    id="paymentTermsDropdown"
                    name="v_terms"
                    required
                  >
                    {% for p in payments %}
                    <option value="{{p.id}}">{{p.Terms}}</option>
                    {% endfor %}
                  </select>
                  <a
                    href="#"
                    class="btn btn-outline-secondary py-2 my-1"
                    id="openPaymentModalBtn"
                    data-target="#newpayment"
                    data-toggle="modal"
                    >+</a
                  >
                </div>
              </div>
            </div>

            <hr />

            <div class="row">
              <div class="col-md-6 mt-5 text-center text-uppercase">
                <h4 class="mb-0">Billing Address</h4>
              </div>
              <div class="col-md-6 mt-5">
                <h4 class="mb-0 text-center text-uppercase">
                  Shipping Address
                </h4>
              </div>
            </div>
            <div class="row mt-2 m-0 p-0 mb-2">
              <div class="col-md-9"></div>
              <div class="col-md-3 text-right m-0 p-0">
                <input
                  type="checkbox"
                  onclick="addressSame()"
                  id="vokay"
                  name="vokay"
                />
                <label for="vokay" style="color: #909091"
                  >Same As Billing Address</label
                >
              </div>
            </div>

            <div class="row mt-5">
              <div class="col-md-1">
                <label for="vstreet">Street</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="vstreet"
                  name="vstreet"
                ></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vsstreet">Street</label>
              </div>
              <div class="col-md-4">
                <textarea
                  class="form-control street text-dark bg-light"
                  id="vsstreet"
                  name="vsstreet"
                ></textarea>
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vcity">City</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vcity"
                  name="vcity"
                  placeholder="City"
                />
              </div>
              <div class="col-md-1"></div>
              <div class="col-md-1">
                <label for="vscity">City</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vscity"
                  name="vscity"
                  placeholder="City"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vstate">State</label>
              </div>
              <div class="col-md-4">
                <select
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vstate"
                  name="vstate"
                >
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">
                    Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">
                    Dadra and Nagar Haveli
                  </option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vsstate">State</label>
              </div>
              <div class="col-md-4">
                <select
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vsstate"
                  name="vsstate"
                >
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">
                    Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">
                    Dadra and Nagar Haveli
                  </option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>

              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vcountry">Country</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vcountry"
                  name="vcountry"
                  placeholder="Country"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vscountry">Country</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vscountry"
                  name="vscountry"
                  placeholder="Country"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vpincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vpincode"
                  name="vpincode"
                  maxlength="6"
                  placeholder="PIN Code"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vspincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vspincode"
                  name="vspincode"
                  maxlength="6"
                  placeholder="PIN Code"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vphone"
                  name="vphone"
                  placeholder="Phone"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vsphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vsphone"
                  name="vsphone"
                  placeholder="Phone"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="vfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vfax"
                  name="vfax"
                  placeholder="FAX"
                />
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="vsfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="vsfax"
                  name="vsfax"
                  placeholder="FAX"
                />
              </div>
              <div class="col-md-1"></div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <input
                  type="checkbox"
                  value=""
                  id="invalidCheck"
                  name="invalidCheck"
                  required
                />
                <label for="invalidCheck" style="color: #909091"
                  >Agree to terms and conditions</label
                >
                <div class="invalid-feedback text-warning">
                  You must agree before submitting.
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="d-flex">
                  <button
                    class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="submit"
                    data-dismiss="modal"
                    id="vendorSave"
                  >
                    Submit
                  </button>

                  <button
                    type="button"
                    class="close btn save_btn rounded-pill text-grey w-50 my-4"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-6"></div>
              <!-- <div class="col-md-4"></div> -->
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 
<!-- end modal -->

 <div class="modal fade" id="newpayment">
  <div class="modal-dialog modal-xl">
    <div
      class="modal-content"
      style="background: rgb(32, 35, 37); border-radius: 20px"
    >
      <div class="modal-header" style="background: rgb(32, 35, 37)">
        <h3 class="m-3 text-uppercase">Add Payment Term</h3>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37)">
        <div class="card p-3 m-3">
          <form
            action=""
            method="post"
            class="needs-validation"
            id="paymentTermsForm"
          >
            {% csrf_token %}
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center>
                  <label for="termname" style="color: rgb(190, 88, 88)"
                    >Term Name *</label
                  >
                </center>
              </div>

              <div class="col-md-4 mt-2">
                <center>
                  <label for="termdays" style="color: rgb(190, 88, 88)"
                    >Number of Days *</label
                  >
                </center>
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="term_name"
                  name="term_name"
                  required
                />
              </div>

              <div class="col-md-4 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="term_days"
                  name="term_days"
                  required
                />
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>

            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button
                    class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="submit"
                    id="paySave"
                  >
                    Save
                  </button>

                  <button
                    type="button"
                    class="close btn save_btn rounded-pill text-grey w-50 my-4"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 

 <div class="modal fade" id="repeatevery">
  <div class="modal-dialog modal-xl">
    <div
      class="modal-content"
      style="background: rgb(32, 35, 37); border-radius: 20px"
    >
      <div class="modal-header" style="background: rgb(32, 35, 37)">
        <h3 class="m-3 text-uppercase">Add Repeat</h3>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37)">
        <div class="card p-3 m-3">
          <form
            action=""
            method="post"
            class="needs-validation"
            novalidate
            autocomplete="off"
            id="repeatForm"
          >
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2 mt-2">
                <center>
                  <label for="termname" style="color: rgb(190, 88, 88)"
                    >Add Repeat*</label
                  >
                </center>
              </div>

              <div class="col-md-4 mt-2">
                <input
                  type="text"
                  class="form-control text-dark bg-light"
                  id="repeats_input"
                  name="repeatname"
                  required
                />
              </div>
            </div>

            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button
                    class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                    type="button"
                    data-dismiss="modal"
                    id="repeatSave"
                  >
                    Save
                  </button>

                  <button
                    type="button"
                    class="close btn save_btn rounded-pill text-grey w-50 my-4"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 

<script>
  $(document).ready(function () {
    $("#repeatForm").submit(function (e) {
      e.preventDefault(); // Prevent the form from submitting traditionally

      // Serialize the form data
      var formData = $(this).serialize();

      // Send an AJAX POST request to the server to save the data
      $.ajax({
        type: "POST",
        url: "{% url 'get_repeat_every' %}", // Replace with the correct URL for your view that saves the item
        data: formData,
        headers: { "X-CSRFToken": "{{ csrf_token }}" },
        success: function (data) {
          // Clear the input field
          $("#repeats_input").val("");

          var dropdown = $("#repeat_select");
          // Only clear and update the dropdown if data.repeat_list exists

          dropdown.empty();

          // Iterate through the received data and add options to the dropdown
          $.each(data, function (key, value) {
            var optionText = value[1];
            var optionValue = key;
            dropdown.append(
              $("<option></option>").attr("value", optionValue).text(optionText)
            );
          });
        },

        error: function (error) {
          console.log("AJAX Error:", error);
        },
      });
    });
  });
</script>

<script>
  $(document).ready(function () {
    $("#repeatSave").click(function (e) {
      e.preventDefault(); // Prevent the form from submitting traditionally

      // Serialize the form data
      var formData = $("#repeatForm").serialize();

      // Send an AJAX POST request to the server to save the data
      $.ajax({
        type: "POST",
        url: "{% url 'get_repeat_every' %}", // Replace with the correct URL for your view that saves the item
        data: formData,
        headers: { "X-CSRFToken": "{{ csrf_token }}" },
        success: function (data) {
          // Clear the input field
          $("#repeats_input").val("");

          var dropdown = $("#repeat_select");
          // Only clear and update the dropdown if data.repeat_list exists
          dropdown.empty();

          // Iterate through the received data and add options to the dropdown
          $.each(data, function (key, value) {
            var optionText = value[1];
            var optionValue = key;
            dropdown.append(
              $("<option></option>").attr("value", optionValue).text(optionText)
            );
          });
        },
        error: function (error) {
          console.log("AJAX Error:", error);
        },
      });
    });
  });
</script> 

<script>
  $(document).ready(function () {
    // AJAX for adding payment term
    $("#paymentTermsForm").submit(function (event) {
      event.preventDefault();
      var formData = $(this).serialize();
      $.ajax({
        url: "{% url 'custmr_payment' %}",
        type: "POST",
        data: formData,
        success: function (data) {
          if (data.success) {
            console.log("Payment term added successfully:", data);
            // Clear the form and reload the dropdown on success
            $("#paymentTermsForm")[0].reset();
            loadPaymentTerms();
            closeForm();
          } else {
            // Handle form validation errors
            console.log("Error adding payment term:", data.errors);
          }
        },
        error: function (error) {
          console.log("Error:", error);
        },
      });
    });

    // Function to load payment terms into the dropdown
    function loadPaymentTerms() {
      $.ajax({
        url: "{% url 'payment_view' %}",
        type: "GET",
        success: function (data) {
          console.log("Received payment terms data:", data);
          var dropdown = $("#c_terms");
          var dropdown1 = $("#paymentTermsDropdown");
          dropdown.empty();
          dropdown1.empty();
          $.each(data, function (key, value) {
            var optionText = value[1];
            var optionValue = key;
            dropdown.append(
              $("<option></option>").attr("value", optionValue).text(optionText)
            );
            dropdown1.append(
              $("<option></option>").attr("value", optionValue).text(optionText)
            );
            console.log("Added option:", optionValue, optionText);
          });
        },
        error: function (error) {
          console.log("Error:", error);
        },
      });
    }

    // Initial load of payment terms
    loadPaymentTerms();
  });
  function closeForm() {
    let formContainer = document.getElementById("newpayment");
    formContainer.style.display = "none";
  }
</script> 

<script>
  function addressSame() {
    const billingStreet = document.getElementById("vstreet").value;
    const billingCity = document.getElementById("vcity").value;
    const billingState = document.getElementById("vstate").value;
    const billingCountry = document.getElementById("vcountry").value;
    const billingPincode = document.getElementById("vpincode").value;
    const billingPhone = document.getElementById("vphone").value;
    const billingFax = document.getElementById("vfax").value;

    if (document.getElementById("vokay").checked) {
      // Set shipping address fields to billing address fields
      document.getElementById("vsstreet").value = billingStreet;
      document.getElementById("vscity").value = billingCity;
      document.getElementById("vsstate").value = billingState;
      document.getElementById("vscountry").value = billingCountry;
      document.getElementById("vspincode").value = billingPincode;
      document.getElementById("vsphone").value = billingPhone;
      document.getElementById("vsfax").value = billingFax;
    } else {
      // Clear the shipping address fields if checkbox is unchecked
      document.getElementById("vsstreet").value = "";
      document.getElementById("vscity").value = "";
      document.getElementById("vsstate").value = "";
      document.getElementById("vscountry").value = "";
      document.getElementById("vspincode").value = "";
      document.getElementById("vsphone").value = "";
      document.getElementById("vsfax").value = "";
    }
  }
</script> 
<script>
  function address() {
    const billingStreet1 = document.getElementById("cstreet1").value;
    const billingStreet2 = document.getElementById("cstreet2").value;
    const billingCity = document.getElementById("ccity").value;
    const billingState = document.getElementById("cstate").value;
    const billingCountry = document.getElementById("ccountry").value;
    const billingPincode = document.getElementById("cpincode").value;
    const billingPhone = document.getElementById("cphone").value;
    const billingFax = document.getElementById("cfax").value;

    if (document.getElementById("csokay").checked) {
      // Set shipping address fields to billing address fields
      document.getElementById("csstreet1").value = billingStreet1;
      document.getElementById("csstreet2").value = billingStreet2;
      document.getElementById("cscity").value = billingCity;
      document.getElementById("csstate").value = billingState;
      document.getElementById("cscountry").value = billingCountry;
      document.getElementById("cspincode").value = billingPincode;
      document.getElementById("csphone").value = billingPhone;
      document.getElementById("csfax").value = billingFax;
    } else {
      // Clear the shipping address fields if checkbox is unchecked
      document.getElementById("csstreet1").value = "";
      document.getElementById("csstreet2").value = "";
      document.getElementById("cscity").value = "";
      document.getElementById("csstate").value = "";
      document.getElementById("cscountry").value = "";
      document.getElementById("cspincode").value = "";
      document.getElementById("csphone").value = "";
      document.getElementById("csfax").value = "";
    }
  }
</script> 

<script>
  $(document).ready(function () {
    $("#v_gsttype").change(function () {
      var x = $("#v_gsttype").val();
      if (x == "unregistered Business") {
        $(".gstrow").addClass("d-none");
      } //else if (x == "Overseas") {
        //$(".gstrow").addClass("d-none");
      //} 
      else {
        $(".gstrow").removeClass("d-none");
        $(".gstrow").addClass("d-flex");
      }
    });
  });

  $(document).ready(function () {
    $("#v_gstin").change(function () {
      var x = $("v_gstin").val();
      var gst_label = document.getElementById("gst_label");
      var expr = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
      if (!expr.test(x)) {
        gst_label.style.color = "red";
        gst_label.innerHTML = "Invalid GST Number.";
      } else {
        gst_label.style.color = "green";
        gst_label.innerHTML = "valid GST Number.";
      }
    });
  });

  $(document).ready(function () {
    $("#v_pan").change(function () {
      var x = $("#v_pan").val();
      var pan_label = document.getElementById("pan_label");
      var expr = /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
      if (!expr.test(x)) {
        pan_label.style.color = "red";
        pan_label.innerHTML = "Invalid PAN Number.";
      } else {
        pan_label.style.color = "green";
        pan_label.innerHTML = "valid PAN Number.";
      }
    });
  });
</script> 

<script>
  $(document).ready(function () {
    $("#c_gsttype").change(function () {
      var x = $("#c_gsttype").val();
      if (x == "Unregistered Business-not Registered under GST") {
        $(".gstroww").addClass("d-none");
      } else if (x == "Overseas") {
        $(".gstroww").addClass("d-none");
      } else {
        $(".gstroww").removeClass("d-none");
        $(".gstroww").addClass("d-flex");
      }
    });
  });

  $(document).ready(function () {
    $("#c_gstin").change(function () {
      var x = $("c_gstin").val();
      var gst_labell = document.getElementById("gst_labell");
      var expr = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
      if (!expr.test(x)) {
        gst_labell.style.color = "red";
        gst_labell.innerHTML = "Invalid GST Number.";
      } else {
        gst_labell.style.color = "green";
        gst_labell.innerHTML = "valid GST Number.";
      }
    });
  });

  $(document).ready(function () {
    $("#c_pan").change(function () {
      var x = $("#c_pan").val();
      var pan_labell = document.getElementById("pan_labell");
      var expr = /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
      if (!expr.test(x)) {
        pan_labell.style.color = "red";
        pan_labell.innerHTML = "Invalid PAN Number.";
      } else {
        pan_labell.style.color = "green";
        pan_labell.innerHTML = "valid PAN Number.";
      }
    });
  });
</script> 

<script>
  function addressSame() {
    const billingStreet = document.getElementById("vstreet").value;
    const billingCity = document.getElementById("vcity").value;
    const billingState = document.getElementById("vstate").value;
    const billingCountry = document.getElementById("vcountry").value;
    const billingPincode = document.getElementById("vpincode").value;
    const billingPhone = document.getElementById("vphone").value;
    const billingFax = document.getElementById("vfax").value;

    if (document.getElementById("vokay").checked) {
      document.getElementById("vsstreet").value = billingStreet;
      document.getElementById("vscity").value = billingCity;
      document.getElementById("vsstate").value = billingState;
      document.getElementById("vscountry").value = billingCountry;
      document.getElementById("vspincode").value = billingPincode;
      document.getElementById("vsphone").value = billingPhone;
      document.getElementById("vsfax").value = billingFax;
    } else {
      // Clear the shipping address fields if checkbox is unchecked
      document.getElementById("vsstreet").value = "";
      document.getElementById("vscity").value = "";
      document.getElementById("vsstate").value = "";
      document.getElementById("vscountry").value = "";
      document.getElementById("vspincode").value = "";
      document.getElementById("vsphone").value = "";
      document.getElementById("vsfax").value = "";
    }
  }
</script> 

 <script>
  $(document).ready(function () {
    $("#vendorSave").on("click", function (event) {
      event.preventDefault();
      var formData = $("#vendorForm").serialize();

      $.ajax({
        url: "{% url 'add_recurring_vendor' %}",
        type: "POST",
        data: formData,
        headers: { "X-CSRFToken": "{{ csrf_token }}" },
        success: function (data) {
          console.log("AJAX Success:", data);

          if (data.success) {
            alert("Vendor added successfully!");
            $("#vendorForm")[0].reset();
            updateVendorDropdown(data.vendorId, data.vendorName); // Pass the newly added vendor's ID and Name
          } else {
            alert("Vendor addition failed!");
          }
        },
        error: function (error) {
          console.log("AJAX Error:", error);
        },
      });
    });

    function updateVendorDropdown(vendorId, vendorName) {
      // Append the new vendor to the select dropdown
      $("#vendorSelect").append(
        $("<option>", {
          value: vendorId,
          text: vendorName,
        })
      );
    }
  });
</script> 
<script>
  var goodsRadio = document.getElementById("expense_type1");
  var goodsBottom = document.getElementById("goods-bottom");

  goodsRadio.addEventListener("change", function () {
    if (this.checked) {
      goodsBottom.style.display = "block";
      servicesBottom.style.display = "none";
    }
  });

  var servicesRadio = document.getElementById("expense_type2");
  var servicesBottom = document.getElementById("services-bottom");

  servicesRadio.addEventListener("change", function () {
    if (this.checked) {
      goodsBottom.style.display = "none";
      servicesBottom.style.display = "block";
    }
  });
</script> 
<script>
  function validateGSTNumber(gstNumber) {
    // Regular expression to validate GST number
    var gstRegex =
      /^([0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1})$/;

    // Check if the entered GST number matches the regex pattern
    if (!gstRegex.test(gstNumber)) {
      alert("Invalid GST number. Please enter a valid GST number.");
      return false;
    }
    return true;
  }

  function validateForm() {
    var gstTreatment = document.getElementById("gst").value;

    // Check if the selected GST treatment requires GST number validation
    if (gstTreatment !== "Unregistered Business-not Registered under GST") {
      var gstNumber = document.getElementById("textbox").value;
      return validateGSTNumber(gstNumber);
    }

    return true;
  }
</script> 
 <script>
  function toggleTextBox() {
    var gstTreatment = document.getElementById("gst_trt_inp").value;
    var textboxContainer = document.getElementById("textboxContainer");
    var textbox = document.getElementById("gstin_inp");

    if (gstTreatment !== "Unregistered Business-not Registered under GST") {
      textboxContainer.style.display = "block";
      textbox.value = getGstNumber();
    } else {
      textboxContainer.style.display = "none";
      textbox.value = "";
    }
  }

  function getGstNumber() {
    var vendorSelect = document.getElementById("vendorSelect");
    var selectedVendorId = vendorSelect.value;
    var selectedVendorOption = vendorSelect.options[vendorSelect.selectedIndex];
    var gstNumber = selectedVendorOption.getAttribute("data-gst-number");
    return gstNumber || ""; // Return an empty string if GST number is undefined
  }

  // Call toggleTextBox initially to set the initial state of the textbox
  toggleTextBox();
</script>

 <script>
  function validateHSN(input) {
    const hsnValue = input.value.trim();
    const hsnError = document.getElementById("hsn-error");

    if (hsnValue.length === 6 && /^[0-9]+$/.test(hsnValue)) {
      hsnError.textContent = "";
    } else {
      hsnError.textContent = "Please enter a valid 6-digit number.";
    }
  }
  function validateSAC(input) {
    const sacValue = input.value.trim();
    const sacError = document.getElementById("sac-error");

    if (sacValue.length === 6 && /^[0-9]+$/.test(sacValue)) {
      sacError.textContent = "";
    } else {
      sacError.textContent = "Please enter a valid 6-digit number.";
    }
  }
</script> 
<script
  src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
  integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
  crossorigin="anonymous"
></script> 

{% endblock %}
